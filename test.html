<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <title>Register Faces</title>
    <script defer src="./js/Notifier.js"></script>
    <script defer src="./js/ImageCapture.js"></script>
    <script defer src="./js/face-api.min.js"></script>
    <style>
        body {
            height: 99vh;
            width: 99vw;
            background-color: #fff;
        }

        #video-element {
            display: block;
            width: 50vw;
            height: 50vh;
            object-fit: cover;
        }
    </style>
</head>

<body>
    <h1>Hello World</h1>

    <input id="input-photos" type="file" multiple="multiple" accept="image/jpeg, image/png, image/jpg" />

    <button>Done</button>

    <script>
        Promise.all([
            faceapi.nets.tinyFaceDetector.loadFromUri("../models"),
            faceapi.nets.faceLandmark68Net.loadFromUri("../models"),
            faceapi.nets.faceRecognitionNet.loadFromUri("../models"),
            faceapi.nets.faceExpressionNet.loadFromUri("../models"),
            faceapi.nets.ssdMobilenetv1.loadFromUri("../models"),
        ])
            .then(() => {
                Emitter.emit(Events.MODEL_LOADED, {
                    message: "Models loaded successfully",
                });
                getStream().catch((error) => {
                    Emitter.emit({ message: "failed tog get stream", error });
                });
            })
            .catch((error) => {
                Emitter.emit(Events.ERROR, { error: "Errors loading models" });
            });

        const label = "yaqoob";
        const data = {};
        const input = document.querySelector("#input-photos");
        input.addEventListener("change", () => {
            const files = input.files;
            for (let i = 0; i < files.length; i++) {
                const picURL = window.URL.createObjectURL(files[i]);

                if (Array.isArray(data[label])) {
                    data[label].push(picURL);
                } else {
                    data[label] = [picURL];
                }
            }
            console.log('==> data', data)
        });
    </script>
</body>

</html>